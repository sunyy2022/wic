<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
        <!-- Updated Meta Info -->
        <meta name="description" content="Tips and tools for overcoming the language barrier in China, including useful translation apps and basic Mandarin phrases." />
        <meta name="author" content="Wander in China" />
        <title>Conquering the Language Barrier in China - Wander in China</title>
        <!-- Favicon (Correct relative path from subpage/blogs/ to root) -->
        <link rel="icon" type="image/png" href="../../assets/img/favicon.png" sizes="32x32" />
        <!-- Bootstrap icons (CDN link, no change needed) -->
        <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css" rel="stylesheet" />
        <!-- Core theme CSS (Correct relative path) -->
        <link href="../../css/styles.css" rel="stylesheet" />
    </head>
    <body class="d-flex flex-column h-100">
        <main class="flex-shrink-0">
            <!-- 页头占位符 -->
            <div id="header-placeholder"></div>

            <!-- 页面内容 -->
            <!-- Blog Post Content Section -->
            <section class="py-5">
                <div class="container px-5 my-5">
                    <!-- Removed justify-content-center from the row -->
                    <div class="row gx-5">
                        <!-- Changed main content column width to col-lg-9 -->
                        <div class="col-lg-9">
                            <!-- Post Title -->
                            <h1 class="fw-bolder mb-4">Conquering the Language Barrier in China: Tips and Tools</h1>

                            <!-- Post Content -->
                            <article>
                                <p class="fs-5 mb-4">Navigating China without fluency in Mandarin can seem daunting, but understanding the language landscape and utilizing available tools can significantly ease your journey. English proficiency in China varies depending on the region and age group. In major metropolitan areas like Beijing, Shanghai, and Guangzhou, particularly within tourist-heavy zones such as airports, upscale hotels, and popular attractions, you'll often encounter individuals capable of communicating in English. Younger generations, having generally received English education in schools, are also more likely to comprehend and respond to basic English inquiries. Furthermore, the Chinese people are renowned for their hospitality. Don't hesitate to speak; locals will often go out of their way to understand and assist you, even if a language gap exists.</p>

                                <!-- Section: Translation Apps -->
                                <h2 class="fw-bolder mt-5 mb-3">Invaluable Translation Apps for Travelers</h2>
                                <p class="fs-5 mb-4">Several translation applications can prove indispensable in overcoming language hurdles during your travels in China.</p>
                                <ul class="list-unstyled mb-4 fs-5">
                                    <li class="mb-3">
                                        <strong class="d-block mb-1">Youdao Translator:</strong> Stands out as a top-tier option. It boasts support for 107 languages, encompassing both standard Mandarin and some minority languages. Leveraging its YNMT neural network translation technology, it delivers highly accurate results. The app offers diverse translation methods, including voice translation for real-time conversations such as ordering food, and photo or augmented reality (AR) translation for deciphering signs and documents.
                                    </li>
                                    <li class="mb-3">
                                        <strong class="d-block mb-1">Baidu Translate:</strong> Is another widely adopted and effective tool. Supporting numerous languages, it provides photo, voice, and text translation functionalities. Its photo translation feature excels with complex Chinese characters, and it can even correct errors in your input to provide more accurate translations.
                                    </li>
                                    <li class="mb-3">
                                        <strong class="d-block mb-1">Sogou Travel Translator:</strong> (also available as a dedicated app) facilitates inter-translation between 18 languages, which is generally sufficient for travel within China. It displays real-time text and translations during voice conversations, and its Optical Character Recognition (OCR) photo translation swiftly interprets road signs and menus. Additionally, it offers robust offline translation capabilities for areas with limited network connectivity.
                                    </li>
                                    <li>
                                        <strong class="d-block mb-1">ChinaGo APP:</strong> Developed by the Bank of China specifically for international visitors, provides translation services for 30 languages without requiring registration. Its voice translation is well-suited for face-to-face interactions, and its picture translation can handle road signs, menus, and more. Notably, it even offers real-time translation for taxi conversations.
                                    </li>
                                </ul>

                                <!-- Section: Basic Phrases -->
                                <h2 class="fw-bolder mt-5 mb-3">Essential Basic Communication Phrases</h2>
                                <p class="fs-5 mb-4">Learning a few simple Mandarin phrases can significantly enhance your interactions and demonstrate your effort to connect with locals.</p>

                                <!-- Image: Greeting -->
                                <figure class="my-5 text-center">
                                    <img class="img-fluid rounded w-75" src="../../assets/img/greeting.jpg" alt="Saying Ni Hao (Hello) in China" />
                                    <figcaption class="mt-2 text-center text-muted small">A simple 'Nǐ hǎo' goes a long way</figcaption>
                                </figure>

                                <!-- Subsection: Greetings -->
                                <h3 class="fw-bolder mt-4 mb-3">Greetings</h3>
                                <ul class="list-unstyled mb-4 fs-5">
                                    <li>"你好 (Nǐ hǎo)" - Hello</li>
                                    <li>"很高兴认识你 (Hěn gāoxìng rènshi nǐ)" - Nice to meet you</li>
                                </ul>

                                <!-- Subsection: Ordering Food -->
                                <h3 class="fw-bolder mt-4 mb-3">Ordering Food</h3>
                                <ul class="list-unstyled mb-4 fs-5">
                                    <li>"菜单 (Càidān)" - Menu</li>
                                    <li>"有没有素食 (Yǒu méiyǒu sùshí)" - Do you have vegetarian food?</li>
                                </ul>

                                <!-- Subsection: Shopping -->
                                <h3 class="fw-bolder mt-4 mb-3">Shopping</h3>
                                <ul class="list-unstyled mb-4 fs-5">
                                    <li>"这个多少钱 (Zhège duōshǎo qián)" - How much is this?</li>
                                    <li>"可以便宜一点吗 (Kěyǐ piányi yīdiǎn ma)" - Can you make it a little cheaper?</li>
                                </ul>

                                <!-- Subsection: Asking Directions -->
                                <h3 class="fw-bolder mt-4 mb-3">Useful Phrases for Asking Directions</h3>
                                <ul class="list-unstyled mb-4 fs-5">
                                    <li>"请问，去… 怎么走 (Qǐngwèn, qù… zěnme zǒu)" - Excuse me, how do I get to...?</li>
                                    <li>"附近有… 吗 (Fùjìn yǒu… ma)" - Is there a... nearby? For example, "附近有医院吗 (Fùjìn yǒu yīyuàn ma)" means "Is there a hospital nearby?"</li>
                                    <li>"地铁站在哪里 (Dìtiězhàn zài nǎlǐ)" - Where is the subway station?</li>
                                </ul>

                                <!-- Concluding Paragraph -->
                                <p class="fs-5 mt-5">By leveraging these translation apps and acquainting yourself with some fundamental Mandarin phrases, you'll find it considerably easier to navigate the language barrier in China, leading to a more enjoyable and enriching travel experience with more meaningful interactions with the local people.</p>

                            </article>
                        </div>

                        <!-- 将侧边栏样式 (bg-light p-3 rounded) 应用到列容器上 -->
                        <div class="col-lg-3 bg-light p-3 rounded"> <!-- 添加了 bg-light p-3 rounded -->
                            <div id="sidebar-placeholder">
                                <!-- sidebar.html 的内容将加载到这里 -->
                            </div>
                        </div>
                    </div>
                </div>
            </section>

        </main>

        <!-- 页脚占位符 -->
        <div id="footer-placeholder"></div>

        <!-- Bootstrap core JS (CDN link, no change needed) -->
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js"></script>
        <!-- Core theme JS (Correct relative path) -->
        <script src="../../js/scripts.js"></script>
        <!-- Components loader (Correct relative path) -->
        <script src="../../js/components.js"></script>
        <!-- Added script to load recent posts -->
        <script>
            document.addEventListener('DOMContentLoaded', function() {
                // Define the URL of the current article to find its data
                const currentArticleUrlFilename = 'language_barrier.html'; // <-- Updated filename

                fetch('../../data/blogs.json') // Fetch the JSON data
                    .then(response => {
                        if (!response.ok) {
                            throw new Error(`HTTP error! status: ${response.status}`);
                        }
                        return response.json();
                    })
                    .then(posts => {
                        // --- Populate Recent Posts (Existing Logic Refactored) ---
                        const recentPostsList = document.getElementById('recent-posts-list');
                        if (recentPostsList) {
                            const sortedPosts = [...posts].sort((a, b) => new Date(b.creationDate) - new Date(a.creationDate));
                            populatePostList(recentPostsList, sortedPosts.slice(0, 3));
                        }

                        // --- Populate You May Be Interested In (New Logic) ---
                        const interestedPostsList = document.getElementById('interested-posts-list');
                        if (interestedPostsList) {
                            const currentArticle = posts.find(post => post.url.endsWith(currentArticleUrlFilename)); // Find current article data

                            if (currentArticle && currentArticle.tags) {
                                const otherPosts = posts.filter(post => !post.url.endsWith(currentArticleUrlFilename)); // Exclude current article
                                const similarPosts = calculateSimilarity(currentArticle, otherPosts);

                                // Sort by similarity score (descending) and take top 3
                                similarPosts.sort((a, b) => b.similarity - a.similarity);
                                populatePostList(interestedPostsList, similarPosts.slice(0, 3));
                            } else {
                                // Handle case where current article or its tags aren't found
                                interestedPostsList.innerHTML = '<div class="p-3 text-warning small">Could not determine related posts.</div>';
                                if (!currentArticle) console.warn(`Could not find article data for URL: ${currentArticleUrlFilename}`);
                                if (currentArticle && !currentArticle.tags) console.warn(`Article "${currentArticle.title}" has no tags for comparison.`);
                            }
                        }
                    })
                    .catch(error => {
                        console.error('Error loading posts:', error);
                        // Display error in both lists if fetch fails
                        const recentPostsList = document.getElementById('recent-posts-list');
                        if (recentPostsList) recentPostsList.innerHTML = '<div class="p-3 text-danger small">Failed to load posts.</div>';
                        const interestedPostsList = document.getElementById('interested-posts-list');
                        if (interestedPostsList) interestedPostsList.innerHTML = '<div class="p-3 text-danger small">Failed to load posts.</div>';
                    });

                // Helper function to calculate similarity based on common tags
                function calculateSimilarity(currentArticle, otherPosts) {
                    const currentTags = new Set(currentArticle.tags);
                    return otherPosts.map(post => {
                        if (!post.tags) return { ...post, similarity: 0 }; // Handle posts without tags
                        const commonTags = post.tags.filter(tag => currentTags.has(tag));
                        return { ...post, similarity: commonTags.length }; // Add similarity score
                    }).filter(post => post.similarity > 0); // Optionally filter out posts with 0 similarity
                }

                // Helper function to populate a list container (Reused for both lists)
                function populatePostList(container, postsToDisplay) {
                    container.innerHTML = ''; // Clear loading/error message
                    if (!postsToDisplay || postsToDisplay.length === 0) {
                        container.innerHTML = '<div class="p-3 text-muted small">No relevant posts found.</div>';
                        return;
                    }
                    postsToDisplay.forEach(post => {
                        const urlParts = post.url.split('/');
                        const linkHref = urlParts[urlParts.length - 1]; // Use filename for link
                        // Ensure image path is relative to the current HTML file's location
                        const imageSrc = `../../${post.image.startsWith('../../') ? post.image.substring(6) : post.image}`;


                        const postElement = document.createElement('a');
                        postElement.href = linkHref;
                        postElement.className = 'list-group-item list-group-item-action p-3 d-flex align-items-start';
                        postElement.innerHTML = `
                            <div style="flex: 1 1 33.33%;" class="me-3"> <!-- Image container -->
                                <img src="${imageSrc}" alt="${post.title} Thumbnail" class="w-100" style="height: 60px; object-fit: cover;">
                            </div>
                            <div style="flex: 2 1 66.67%;"> <!-- Text container -->
                                <div class="fw-semibold small">${post.title}</div>
                                <div class="small text-muted">${post.creationDate}</div>
                            </div>
                        `;
                        container.appendChild(postElement);
                    });
                }
            });
        </script>
    </body>
</html>