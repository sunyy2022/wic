<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
        <!-- Updated Meta Info -->
        <meta name="description" content="A local's guide to navigating China's public transportation, including subways, buses, taxis, ride-hailing (Didi), and shared bikes." />
        <meta name="author" content="Wander in China" />
        <title>Navigating China: A Local's Guide to Public Transportation - Wander in China</title>
        <!-- Favicon (Correct relative path from subpage/blogs/ to root) -->
        <link rel="icon" type="image/png" href="../../assets/img/favicon.png" sizes="32x32" />
        <!-- Bootstrap icons (CDN link, no change needed) -->
        <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css" rel="stylesheet" />
        <!-- Core theme CSS (Correct relative path) -->
        <link href="../../css/styles.css" rel="stylesheet" />
    </head>
    <body class="d-flex flex-column h-100">
        <main class="flex-shrink-0">
            <!-- 页头占位符 -->
            <div id="header-placeholder"></div>

            <!-- 页面内容 -->
            <!-- Blog Post Content Section -->
            <section class="py-5">
                <div class="container px-5 my-5">
                    <!-- Removed justify-content-center from the row -->
                    <div class="row gx-5">
                        <!-- Changed main content column width to col-lg-9 -->
                        <div class="col-lg-9">
                            <!-- Post Title -->
                            <h1 class="fw-bolder mb-4">Navigating China: A Local's Guide to Public Transportation</h1>

                            <!-- Post Content -->
                            <article>
                                <p class="fs-5 mb-4">Exploring China's bustling cities is made easier and more affordable by its extensive and efficient public transportation network. From the rapid subway systems to the ubiquitous buses and convenient ride-hailing apps, here's how to navigate like a local.</p>

                                <!-- Section: Subway -->
                                <h2 class="fw-bolder mt-5 mb-3">Subway: The Fast and Convenient Option</h2>

                                <!-- Subsection: Navigating the Network -->
                                <h3 class="fw-bolder mt-4 mb-3">Navigating the Subway Network</h3>
                                <p class="fs-5 mb-4">In major Chinese cities such as Beijing, Shanghai, Guangzhou, and Shenzhen, the subway is a comprehensive and highly efficient mode of transport. Subway stations are easily identifiable by their clear signage featuring the subway logo. Once inside, look for the large subway maps displayed prominently. These maps illustrate all the subway lines, individual stations, and interchange points. Each line is color-coded, simplifying route planning. For instance, in Beijing, Line 2 is a circular line that loops around the city center, while Line 1 runs east-west, connecting major commercial districts.</p>

                                <!-- Image: Subway -->
                                <figure class="my-5 text-center">
                                    <img class="img-fluid rounded w-75" src="../../assets/img/subway.jpg" alt="Chinese Subway Station Map" />
                                    <figcaption class="mt-2 text-center text-muted small">Subway maps are clear and often color-coded</figcaption>
                                </figure>

                                <!-- Subsection: Tickets and Passes -->
                                <h3 class="fw-bolder mt-4 mb-3">Buying Tickets and Passes</h3>
                                <ul class="list-unstyled mb-4 fs-5">
                                    <li class="mb-3"><strong class="d-block mb-1">Single-Journey Tickets:</strong> You can purchase single-journey tickets from the ticket vending machines located within the subway stations. These machines typically offer an English-language interface. Simply select your destination station on the touchscreen map, insert the required fare (most machines accept cash, coins, and increasingly, mobile payments like Alipay and WeChat Pay), and the machine will dispense a plastic token.</li>
                                    <li class="mb-3"><strong class="d-block mb-1">Transportation Cards:</strong> Many cities offer rechargeable transportation cards, such as the Beijing Yikatong or the Shanghai Metro Card. You can buy and top up these cards at subway station service counters. These cards offer a more convenient way to pay for multiple rides, eliminating the need to purchase a new ticket each time. Upon completion of your trip, you can often return the card at designated stations to receive a refund of any remaining balance and the initial card deposit.</li>
                                    <li><strong class="d-block mb-1">Boarding the Subway:</strong> Follow the directional signs to the correct platform. Pay close attention to the indicated train direction (usually displayed by the final destination station on that line) and the platform number. When the train arrives, allow passengers to exit before boarding. If standing, ensure you hold onto the handrails, and keep your personal belongings secure.</li>
                                </ul>

                                <!-- Section: Buses -->
                                <h2 class="fw-bolder mt-5 mb-3">Buses: A Cost-Effective Choice</h2>

                                <!-- Subsection: Finding Routes -->
                                <h3 class="fw-bolder mt-4 mb-3">Finding Bus Routes</h3>
                                <p class="fs-5 mb-4">Bus stops in China are marked with signs displaying the bus numbers and their respective routes. For more detailed information and real-time updates, you can utilize mobile applications like Baidu Maps or Google Maps (where accessible). Input your starting point and destination, and the app will display available bus lines, along with estimated travel times and any necessary transfer information.</p>

                                <!-- Image: Bus -->
                                <figure class="my-5 text-center">
                                    <img class="img-fluid rounded w-75" src="../../assets/img/bus.jpg" alt="City Bus in China" />
                                    <figcaption class="mt-2 text-center text-muted small">Buses are a common and affordable way to get around</figcaption>
                                </figure>

                                <!-- Subsection: Paying for Rides -->
                                <h3 class="fw-bolder mt-4 mb-3">Paying for Bus Rides</h3>
                                <ul class="list-unstyled mb-4 fs-5">
                                    <li class="mb-3"><strong class="d-block mb-1">Cash:</strong> Paying the bus fare with cash is an option. Most buses in urban areas operate on a flat-fare system, typically costing around 1-2 yuan. It's crucial to have the exact fare as drivers may not be able to provide change.</li>
                                    <li><strong class="d-block mb-1">Mobile Payments:</strong> Similar to the subway, many buses now accept mobile payments through Alipay and WeChat Pay. You'll usually find a QR code displayed near the bus entrance. Scan the code with your preferred app and follow the prompts to complete the payment. Some cities also support the use of transportation cards for bus fares.</li>
                                </ul>

                                <!-- Section: Taxis and Ride-Hailing -->
                                <h2 class="fw-bolder mt-5 mb-3">Taxis and Ride-Hailing Services</h2>

                                <!-- Subsection: Taxis -->
                                <h3 class="fw-bolder mt-4 mb-3">Taxis</h3>
                                <ul class="list-unstyled mb-4 fs-5">
                                    <li class="mb-3"><strong class="d-block mb-1">Hailing a Taxi:</strong> In city centers, you can hail a taxi directly from the street. Look for taxis displaying an illuminated "Empty" sign. When you spot one, raise your hand to signal. In some areas, designated taxi stands exist where you will need to join a queue.</li>
                                    <li><strong class="d-block mb-1">Payment:</strong> Taxis in China typically use a meter to calculate the fare based on the distance traveled and any waiting time incurred due to traffic. Payment can be made via cash, credit card, or mobile payment. The driver will provide a receipt upon request.</li>
                                </ul>

                                <!-- Subsection: Ride-Hailing (Didi) -->
                                <h3 class="fw-bolder mt-4 mb-3">Ride-Hailing (Didi)</h3>
                                <ul class="list-unstyled mb-4 fs-5">
                                    <li class="mb-3"><strong class="d-block mb-1">Using the Didi App:</strong> Download the Didi Chuxing app to your phone before arriving in China. Register using your phone number or other available sign-up methods. Enter your desired pick-up location and destination within the app. The app will then display the estimated fare and the anticipated waiting time for your driver. Didi offers various ride options, including economy, premium, and carpooling services.</li>
                                    <li><strong class="d-block mb-1">Payment:</strong> Didi supports multiple payment methods, including Alipay, WeChat Pay, and credit cards. The fare is automatically deducted from your chosen payment method upon completion of the ride.</li>
                                </ul>

                                <!-- Image: Didi -->
                                <figure class="my-5 text-center">
                                    <img class="img-fluid rounded w-50" src="../../assets/img/didi.jpg" alt="Didi Ride-Hailing App Interface" />
                                    <figcaption class="mt-2 text-center text-muted small">Ride-hailing apps like Didi are very popular</figcaption>
                                </figure>

                                <!-- Section: Shared Bikes and E-Scooters -->
                                <h2 class="fw-bolder mt-5 mb-3">Shared Bikes and E-Scooters</h2>

                                <!-- Subsection: Renting Shared Bikes -->
                                <h3 class="fw-bolder mt-4 mb-3">Renting Shared Bikes</h3>
                                <ul class="list-unstyled mb-4 fs-5">
                                    <li class="mb-3"><strong class="d-block mb-1">Popular Bike-Sharing Brands:</strong> Brands like Mobike and Hello Bike are prevalent in many Chinese cities. To rent a shared bike, download the corresponding mobile application. Within the app, you can locate nearby available bikes on the integrated map.</li>
                                    <li><strong class="d-block mb-1">Rental Process:</strong> Scan the QR code located on the bike using the app. This action will unlock the bike, allowing you to begin your ride. Rental fees are typically calculated on an hourly or per-minute basis. Once you've finished your journey, lock the bike in a designated public parking area.</li>
                                </ul>

                                <!-- Image: Shared Bike -->
                                <figure class="my-5 text-center">
                                    <img class="img-fluid rounded w-75" src="../../assets/img/shared_bike.jpg" alt="Shared Bikes parked on a street in China" />
                                    <figcaption class="mt-2 text-center text-muted small">Shared bikes offer a flexible way to explore</figcaption>
                                </figure>

                                <!-- Subsection: E-Scooters -->
                                <h3 class="fw-bolder mt-4 mb-3">E-Scooters</h3>
                                <p class="fs-5 mb-4">Some cities also offer shared e-scooter services. The rental process mirrors that of shared bikes. However, it is strongly recommended to wear a helmet when operating an e-scooter and to strictly adhere to local traffic regulations.</p>

                                <!-- Concluding Paragraph -->
                                <p class="fs-5 mt-5">China's public transportation system is extensive and efficient, making it a great way for tourists to explore. By familiarizing yourself with the options like high-speed rail, subways, buses, and ride-hailing apps, you can navigate the country with confidence and ease.</p>

                            </article>
                        </div>

                        <!-- 将侧边栏样式 (bg-light p-3 rounded) 应用到列容器上 -->
                        <div class="col-lg-3 bg-light p-3 rounded"> <!-- 添加了 bg-light p-3 rounded -->
                            <div id="sidebar-placeholder">
                                <!-- sidebar.html 的内容将加载到这里 -->
                            </div>
                        </div>
                    </div>
                </div>
            </section>

        </main>

        <!-- 页脚占位符 -->
        <div id="footer-placeholder"></div>

        <!-- Bootstrap core JS (CDN link, no change needed) -->
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js"></script>
        <!-- Core theme JS (Correct relative path) -->
        <script src="../../js/scripts.js"></script>
        <!-- Components loader (Correct relative path) -->
        <script src="../../js/components.js"></script>
        <!-- Added script to load recent posts -->
        <script>
            document.addEventListener('DOMContentLoaded', function() {
                // Define the URL of the current article to find its data
                const currentArticleUrlFilename = 'public_transportation.html'; // <-- Updated filename

                fetch('../../data/blogs.json') // Fetch the JSON data
                    .then(response => {
                        if (!response.ok) {
                            throw new Error(`HTTP error! status: ${response.status}`);
                        }
                        return response.json();
                    })
                    .then(posts => {
                        // --- Populate Recent Posts (Existing Logic Refactored) ---
                        const recentPostsList = document.getElementById('recent-posts-list');
                        if (recentPostsList) {
                            const sortedPosts = [...posts].sort((a, b) => new Date(b.creationDate) - new Date(a.creationDate));
                            populatePostList(recentPostsList, sortedPosts.slice(0, 3));
                        }

                        // --- Populate You May Be Interested In (New Logic) ---
                        const interestedPostsList = document.getElementById('interested-posts-list');
                        if (interestedPostsList) {
                            const currentArticle = posts.find(post => post.url.endsWith(currentArticleUrlFilename)); // Find current article data

                            if (currentArticle && currentArticle.tags) {
                                const otherPosts = posts.filter(post => !post.url.endsWith(currentArticleUrlFilename)); // Exclude current article
                                const similarPosts = calculateSimilarity(currentArticle, otherPosts);

                                // Sort by similarity score (descending) and take top 3
                                similarPosts.sort((a, b) => b.similarity - a.similarity);
                                populatePostList(interestedPostsList, similarPosts.slice(0, 3));
                            } else {
                                // Handle case where current article or its tags aren't found
                                interestedPostsList.innerHTML = '<div class="p-3 text-warning small">Could not determine related posts.</div>';
                                if (!currentArticle) console.warn(`Could not find article data for URL: ${currentArticleUrlFilename}`);
                                if (currentArticle && !currentArticle.tags) console.warn(`Article "${currentArticle.title}" has no tags for comparison.`);
                            }
                        }
                    })
                    .catch(error => {
                        console.error('Error loading posts:', error);
                        // Display error in both lists if fetch fails
                        const recentPostsList = document.getElementById('recent-posts-list');
                        if (recentPostsList) recentPostsList.innerHTML = '<div class="p-3 text-danger small">Failed to load posts.</div>';
                        const interestedPostsList = document.getElementById('interested-posts-list');
                        if (interestedPostsList) interestedPostsList.innerHTML = '<div class="p-3 text-danger small">Failed to load posts.</div>';
                    });

                // Helper function to calculate similarity based on common tags
                function calculateSimilarity(currentArticle, otherPosts) {
                    const currentTags = new Set(currentArticle.tags);
                    return otherPosts.map(post => {
                        if (!post.tags) return { ...post, similarity: 0 }; // Handle posts without tags
                        const commonTags = post.tags.filter(tag => currentTags.has(tag));
                        return { ...post, similarity: commonTags.length }; // Add similarity score
                    }).filter(post => post.similarity > 0); // Optionally filter out posts with 0 similarity
                }

                // Helper function to populate a list container (Reused for both lists)
                function populatePostList(container, postsToDisplay) {
                    container.innerHTML = ''; // Clear loading/error message
                    if (!postsToDisplay || postsToDisplay.length === 0) {
                        container.innerHTML = '<div class="p-3 text-muted small">No relevant posts found.</div>';
                        return;
                    }
                    postsToDisplay.forEach(post => {
                        const urlParts = post.url.split('/');
                        const linkHref = urlParts[urlParts.length - 1]; // Use filename for link
                        // Ensure image path is relative to the current HTML file's location
                        const imageSrc = `../../${post.image.startsWith('../../') ? post.image.substring(6) : post.image}`;


                        const postElement = document.createElement('a');
                        postElement.href = linkHref;
                        postElement.className = 'list-group-item list-group-item-action p-3 d-flex align-items-start';
                        postElement.innerHTML = `
                            <div style="flex: 1 1 33.33%;" class="me-3"> <!-- Image container -->
                                <img src="${imageSrc}" alt="${post.title} Thumbnail" class="w-100" style="height: 60px; object-fit: cover;">
                            </div>
                            <div style="flex: 2 1 66.67%;"> <!-- Text container -->
                                <div class="fw-semibold small">${post.title}</div>
                                <div class="small text-muted">${post.creationDate}</div>
                            </div>
                        `;
                        container.appendChild(postElement);
                    });
                }
            });
        </script>
    </body>
</html>